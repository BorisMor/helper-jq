!function(window){"use strict";var ClassHelperJQ=function(){var self=this;function _linkAction(el,context,handler,action){el.on(action,function(event){event.preventDefault(),startFunctionInContext(handler,context,[event])})}function startFunctionInContext(handler,context,params){params=void 0===params?[]:params,"function"==typeof context[handler]?context[handler].apply(context,params):console.error('not function "'+handler+'"',context,params)}function _setValBySource(el,value,sourceData){if("radio"===sourceData)self.setRadioValue(el,value);else if("checkbox"===sourceData)self.setCheckboxValue(el,value);else{var setFunction="set"+sourceData,contextObject=el.data("context-object");"function"!=typeof contextObject[setFunction]?console.error("not fount function "+setFunction,contextObject):contextObject[setFunction].apply(contextObject,[el,value])}}function _getValBySource(el,sourceData){if("radio"===sourceData)return self.getRadioValue(el);if("checkbox"===sourceData)return self.getCheckboxValue(el);var getFunction="get"+sourceData,contextObject=el.data("context-object");if("function"==typeof contextObject[getFunction])return contextObject[getFunction].apply(contextObject,[el]);console.error("not fount function "+getFunction,contextObject)}this.debug=!1,this.prefixClassCSS="js",this.isWorkContext=function(el,context){var nameWorkController;if(!(nameWorkController=el.data("context"))){var workController=el.closest("[data-controller]");if(!self.empty(workController)){var nameWorkController=workController.data("controller");el.data("context",nameWorkController)}}var currentController=self.getContextName(context);return nameWorkController?nameWorkController===currentController:(el.data("context",currentController),!0)},this.linkAction=function(rootDOM,context){if(self.empty(rootDOM))console.error("linkAction: rootDOM is empty",context);else for(var contextName=self.getContextName(context),lenContextName=contextName.length+1,lstElem=$(rootDOM).find("[data-handler]"),i=0,len=lstElem.length;i<len;i++){var el=$(lstElem[i]),handler=el.data("handler"),action=el.data("action");action=void 0===action?"click":action,self.isWorkContext(el,context)?(handler.substr(0,lenContextName)===contextName+"."&&(handler=handler.substr(lenContextName)),self.debug&&console.log("linkAction",handler,action,el,context),_linkAction(el,context,handler,action)):self.debug&&console.log("skip linkAction","for "+el.data("context"),handler,action,el,context)}},this.assign=function(obj,prop,value,context){if("string"==typeof prop&&(prop=prop.split(".")),prop.length>1){var e=prop.shift();self.assign(obj[e]=self.isObject(obj[e])?obj[e]:{},prop,value,context)}else{var property=prop[0];obj.hasOwnProperty(property)?(value.data("context-object",context),obj[property]=value):console.error('not propery "'+property+'"',obj,context)}},this.standardConnection=function(context,containerUI,rootDOM){void 0===containerUI&&(containerUI=context.ui),void 0===rootDOM&&(rootDOM=containerUI.root),self.linkAction(rootDOM,context),self.linkUI(rootDOM,containerUI,context),self.setClassCSSContext(rootDOM,context)},this.setClassCSSContext=function(DOM,context,prefix){var prefix=void 0===prefix?self.prefixClassCSS:prefix,nameContext=self.getContextName(context);$(DOM).addClass(prefix+nameContext)},this.linkUI=function(rootDOM,container,context){if(self.empty(rootDOM))console.error("linkUI: rootDOM is empty",self);else{for(var contextName=self.getContextName(context),lenContextName=contextName.length+1,lstElem=$(rootDOM).find("[data-ui]"),i=0,len=lstElem.length;i<len;i++){var el,nameUI=(el=$(lstElem[i])).data("ui"),skipCheckContext=!1;nameUI.substr(0,lenContextName)===contextName+"."&&(nameUI=nameUI.substr(lenContextName),skipCheckContext=!0),skipCheckContext||self.isWorkContext(el,context)?(self.debug&&console.log("data-ui",nameUI,el,context),self.assign(container,nameUI,el,context)):self.debug&&console.log("skip data-ui","for "+el.data("context"),nameUI,el,context)}for(var i=0,len=(lstElem=self.empty(context)?[]:$(rootDOM).find("[data-ui-context]")).length;i<len;i++){var el,handler=(el=$(lstElem[i])).data("ui-context"),skipCheckContext=!1;handler.substr(0,lenContextName)===contextName+"."&&(handler=handler.substr(lenContextName),skipCheckContext=!0),skipCheckContext||self.isWorkContext(el,context)?(self.debug&&console.log("data-ui-context",handler,el,context),startFunctionInContext(handler,context,[el,container])):self.debug&&console.log("skip ui-context","for "+el.data("context"),handler,el,context)}self.checkUI(container,context)}},this.empty=function(value){return null==value||0===value||void 0!==value.length&&0===value.length},this.checkUI=function(container,infoContext){for(var property in container)if(container.hasOwnProperty(property)){var val=container[property];self.empty(val)&&console.error('property "'+property+'" is empty',container,infoContext)}},this.getContextName=function(context){var type;if("function"===typeof context)var name=context.name;else var name=context.constructor.name;return name},this.getTemplate=function(idTemplate){return"string"==typeof idTemplate?$($("#"+idTemplate).html()):$(idTemplate.html())},this.singleComponent=function(DOM,ClassComponent){var root=$(DOM);if(!self.empty(root)){var nameComponent=self.getContextName(ClassComponent),component=root.data(nameComponent);return void 0===component&&(root.attr("data-controller",nameComponent),root.data("controller",nameComponent),component=new ClassComponent(root),root.data(nameComponent,component)),component}console.error("not found DOM ",DOM,ClassComponent)},this.initSingleComponent=function(select,ClassComponent,maybeEmpty){var nameComponent=self.getContextName(ClassComponent);select=void 0===select?'[data-controller="'+nameComponent+'"]':select;for(var lst=$(select),i=0,len=lst.length;i<len;i++)self.singleComponent(lst[i],ClassComponent);return 0!==lst.length||maybeEmpty||console.error("initSingleComponent: not found",select),result},this.toggleCssClass=function(el,cssClass,condition){condition?$(el).addClass(cssClass):$(el).removeClass(cssClass)},this.toggleShow=function(el,condition){condition?$(el).show():$(el).hide()},this.isKeyCodeChar=function(keyCode){return-1===[16,17,18,27,37,38,39,40].indexOf(keyCode)},this.onChangeData=function(el,funChange){el.is(":checkbox")||el.is(":radio")?el.on("change",funChange):el.is("input")||el.is("textarea")?el.on("keyup",function(event){self.isKeyCodeChar(event.keyCode)&&funChange(event)}):el.on("change",funChange)},this.getRadioValue=function(el){return el.find("input:checked").prop("value")},this.setRadioValue=function(el,val){el.find('input[value="'+val+'"]').prop("checked",!0)},this.getCheckboxValue=function(el){for(var result=[],items=el.find("input:checked"),i=0,len=items.length;i<len;i+=1)result.push($(items[i]).prop("value"));return result},this.setCheckboxValue=function(el,val){var items=val;helperJQ.isArray(val)||(items=[val]);for(var i=0,len=items.length;i<len;i+=1)el.find('input[value="'+items[i]+'"]').prop("checked",!0)},this.setVal=function(el,value,elementHtml){if(el&&el.length){var sourceData=el.data("ui-source");if(!elementHtml&&sourceData)_setValBySource(el,value,sourceData);else if(el.is(":checkbox")||el.is(":radio"))if("boolean"==typeof value)el.prop("checked",value);else{var test=el.val();el.prop("checked",value===test)}else void 0!==el[0].value?el.val(value):el.html(value)}},this.getVal=function(el,elementHtml){if(el&&el.length){if(self.isObject(el)&&!self.isObjectJQuery(el)){var result={};for(var key in el)result[key]=self.getVal(el[key],elementHtml);return result}var sourceData=el.data("ui-source");return!elementHtml&&sourceData?_getValBySource(el,sourceData):void 0!==el[0].value?el.val():el.html()}},this.isObject=function(obj){return obj&&"[object Object]"===Object.prototype.toString.call(obj)},this.isObjectJQuery=function(obj){return self.isObject(obj)&&obj instanceof jQuery},this.isArray=function(obj){return"[object Array]"===Object.prototype.toString.call(obj)},this.linkDataUI=function(data,uiList,eventProcess){function getProcessChange(iEl,iKey){var key=iKey,el=iEl;return function(){data[key]=self.getVal(el),"function"==typeof eventProcess&&eventProcess.apply(self,[key])}}for(var key in data){var el=uiList[key];el&&(self.setVal(el,data[key]),eventProcess&&self.onChangeData(el,getProcessChange(el,key)))}}};window.helperJQ=new ClassHelperJQ}(window);