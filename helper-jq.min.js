!function(window){"use strict";window.helperJQ=new function(){var self=this;function _linkAction(el,context,handler,action){el.on(action,function(event){event.preventDefault(),startFunctionInContext(handler,context,[event])})}function startFunctionInContext(handler,context,params){params=void 0===params?[]:params,"function"==typeof context[handler]?context[handler].apply(context,params):console.error('not function "'+handler+'"',context,params)}this.debug=!1,this.prefixClassCSS="js",this.isWorkContext=function(el,context){var workController=el.closest("[data-controller]");if(!self.empty(workController)){var nameWorkController=workController.data("controller"),currentController=self.getContextName(context);return el.data("context",nameWorkController),nameWorkController===currentController}return!0},this.linkAction=function(rootDOM,context){if(self.empty(rootDOM))console.error("linkAction: rootDOM is empty",context);else for(var lstElem=$(rootDOM).find("[data-handler]"),i=0,len=lstElem.length;i<len;i++){var el=$(lstElem[i]),handler=el.data("handler"),action=el.data("action");action=void 0===action?"click":action,self.isWorkContext(el,context)?(self.debug&&console.log("linkAction",handler,action,el,context),_linkAction(el,context,handler,action)):self.debug&&console.log("skip linkAction","for "+el.data("context"),handler,action,el,context)}},this.assign=function(obj,prop,value,context){if("string"==typeof prop&&(prop=prop.split(".")),prop.length>1){var e=prop.shift();self.assign(obj[e]="[object Object]"===Object.prototype.toString.call(obj[e])?obj[e]:{},prop,value,context)}else{var property=prop[0];obj.hasOwnProperty(property)?obj[property]=value:console.error('not propery "'+property+'"',obj,context)}},this.standardConnection=function(context,containerUI,rootDOM){void 0===containerUI&&(containerUI=context.ui),void 0===rootDOM&&(rootDOM=containerUI.root),self.linkAction(rootDOM,context),self.linkUI(rootDOM,containerUI,context),self.setClassCSSContext(rootDOM,context)},this.setClassCSSContext=function(DOM,context,prefix){prefix=void 0===prefix?self.prefixClassCSS:prefix;var nameContext=self.getContextName(context);$(DOM).addClass(prefix+nameContext)},this.linkUI=function(rootDOM,container,context){if(self.empty(rootDOM))console.error("linkUI: rootDOM is empty",self);else{for(var lstElem=$(rootDOM).find("[data-ui]"),i=0,len=lstElem.length;i<len;i++){var nameUI=(el=$(lstElem[i])).data("ui");self.isWorkContext(el,context)?(self.debug&&console.log("data-ui",nameUI,el,context),self.assign(container,nameUI,el,context)):self.debug&&console.log("skip data-ui","for "+el.data("context"),nameUI,el,context)}for(i=0,len=(lstElem=self.empty(context)?[]:$(rootDOM).find("[data-ui-context]")).length;i<len;i++){var el,handler=(el=$(lstElem[i])).data("ui-context");self.isWorkContext(el,context)?(self.debug&&console.log("data-ui-context",handler,el,context),startFunctionInContext(handler,context,[el,container])):self.debug&&console.log("skip ui-context","for "+el.data("context"),handler,el,context)}self.checkUI(container)}},this.empty=function(value){return null==value||0===value||void 0!==value.length&&0===value.length},this.checkUI=function(container){for(var property in container)if(container.hasOwnProperty(property)){var val=container[property];self.empty(val)&&console.error('property "'+property+'" is empty',container)}},this.getContextName=function(context){if("function"==typeof context)var name=context.name;else name=context.constructor.name;return name},this.getTemplate=function(idTemplate){return"string"==typeof idTemplate?$($("#"+idTemplate).html()):$(idTemplate.html())},this.singleComponent=function(DOM,ClassComponent){var root=$(DOM);if(!self.empty(root)){var nameComponent=self.getContextName(ClassComponent),component=root.data(nameComponent);return void 0===component&&(root.attr("data-controller",nameComponent),root.data("controller",nameComponent),component=new ClassComponent(root),root.data(nameComponent,component)),component}console.error("not found DOM ",DOM,ClassComponent)},this.initSingleComponent=function(select,ClassComponent){var nameComponent=self.getContextName(ClassComponent);select=void 0===select?'[data-controller="'+nameComponent+'"]':select;for(var lst=$(select),i=0,len=lst.length;i<len;i++)self.singleComponent(lst[i],ClassComponent)}}}(window);
